--业务初始化脚本 by 梁恩贵
--
CREATE NICKNAME DB2ADMIN.N_RIM_CUST FOR RIMDB.DB2ADMIN.RIM_CUST;

CREATE NICKNAME DB2ADMIN.N_SD_ITEM FOR RIMDB.DB2ADMIN.SD_ITEM;
CREATE NICKNAME DB2ADMIN.N_SD_ITEM_TOBACCO  FOR RIMDB.DB2ADMIN.SD_ITEM_TOBACCO;
CREATE NICKNAME DB2ADMIN.N_SD_UM            FOR RIMDB.DB2ADMIN.SD_UM          ;
CREATE NICKNAME DB2ADMIN.N_SD_ITEM_UM       FOR RIMDB.DB2ADMIN.SD_ITEM_UM     ;
CREATE NICKNAME DB2ADMIN.N_SD_ITEM_PRI      FOR RIMDB.DB2ADMIN.SD_ITEM_PRI    ;
CREATE NICKNAME DB2ADMIN.N_SD_ITEM_COM      FOR RIMDB.DB2ADMIN.SD_ITEM_COM    ;
CREATE NICKNAME DB2ADMIN.N_SD_BRAND         FOR RIMDB.DB2ADMIN.SD_BRAND       ;
--删除广西未经营的卷烟

DELETE FROM PUB_GOODS_RELATION A
WHERE TENANT_ID=450000001 AND RELATION_ID=1000006 AND A.GODS_ID NOT IN (SELECT B.GODS_ID FROM n_sd_item A ,PUB_GOODSINFO B,PUB_BARCODE C
WHERE A.PACK_BAR=C.BARCODE AND B.TENANT_ID=C.TENANT_ID AND B.GODS_ID=C.GODS_ID AND BARCODE_TYPE='1' AND C.TENANT_ID=110000001);

--核对数据
--select * from GXPROD a where pack_bar not in (select barcode from pub_goodsinfo b) AND A.ITEM_CODE NOT LIKE '%A%';
--导入广西测试数据.sql

SELECT A.BIG_UNITS,B.SMALLTO_CALC,A.* FROM GXPROD A,PUB_GOODSINFO B
WHERE A.PACK_BAR=B.BARCODE AND A.BIG_UNITS*1.000<>B.SMALLTO_CALC;
